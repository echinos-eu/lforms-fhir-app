"use strict";(()=>{var e=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),t=e(((e,t)=>{t.exports=["29.0.0","28.0.0","26.0.0","25.0.0","24.0.0","23.0.0","22.0.0"]})),o=e(((e,t)=>{var o=/^lformsVersion: (.+)$/;t.exports={isFHIRResource:function(e){return!!e.resourceType},findExtensions:function(e,t){e.extension&&t(e.extension);let o=e.item||e.items;if(o)for(let e of o)this.findExtensions(e,t)},findItemByExtension:function(e,t){e.extension&&t(e);let o=e.item||e.items;if(o)for(let e of o)this.findItemByExtension(e,t)},versionLessThan:function(e,t){let o;if(e){let r=e.split("."),i=t.split(".");for(let e=0;e<3&&void 0===o;++e){let t=parseInt(r[e]),n=parseInt(i[e]);t!=n&&(o=t<n)}void 0===o&&(o=!1)}else o=!0;return o},makeVersionTag:function(e){return"lformsVersion: "+e},versionFromTag:function(e){let t=null,r=(e.code||e.display).match(o);return r&&(t=r[1]),t},hasLformsTag(e){if(e.meta&&e.meta.tag)for(let t of e.meta.tag)if(t.code&&t.code.match(o))return!0;return!1}}})),r=e(((e,t)=>{t.exports=function(e){let t=o();return(!t.isFHIRResource(e)||"Questionnaire"===e.resourceType)&&t.findExtensions(e,(function(e){for(let t of e)"http://hl7.org/fhir/StructureDefinition/questionnaire-launchContext"===t.url&&(t.url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-launchContext")})),e}})),i=e(((e,t)=>{t.exports=function(e){let t=o();return(!t.isFHIRResource(e)||"Questionnaire"===e.resourceType&&t.hasLformsTag(e))&&t.findExtensions(e,(function(e){for(let t of e)if("http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-observationLinkPeriod"===t.url){e.push({url:"http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-observationExtract",valueBoolean:!0});break}})),e}})),n=e(((e,t)=>{t.exports=function(e){return o().isFHIRResource(e)||("object"==typeof e.templateOptions?(void 0===e.templateOptions.hideFormControls&&(e.templateOptions.hideFormControls=!1),void 0===e.templateOptions.showFormHeader&&(e.templateOptions.showFormHeader=!0)):e.templateOptions={hideFormControls:!1,showFormHeader:!0}),e}})),s=e(((e,t)=>{t.exports=function(e){let t=o();return(!t.isFHIRResource(e)||"Questionnaire"===e.resourceType)&&t.findExtensions(e,(function(e){for(let t of e)"http://hl7.org/fhir/StructureDefinition/questionnaire-calculatedExpression"===t.url&&(t.url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression")})),e}})),a=e(((e,t)=>{var r="/";function i(e){s(e.items,"",e),a(e.items),n(e.items)}function n(e){for(var t=0,o=e.length;t<o;t++){var r=e[t];delete r._parentItem,delete r._codePath,r.items&&r.items.length>0&&n(r.items)}}function s(e,t,o){for(var i=e.length,n=null,a=0;a<i;a++){var u=e[a];u.questionCardinality&&u.questionCardinality.max&&("*"===u.questionCardinality.max||parseInt(u.questionCardinality.max)>1)&&n&&n.questionCode===u.questionCode?1:1;var l=t+r+u.questionCode;u._parentItem=o,u._codePath=l,u.linkId||(u.linkId=l),n=u,u.items&&u.items.length>0&&s(u.items,l,u)}}function a(e){for(var t=0,o=e.length;t<o;t++){var r=e[t];if(r.skipLogic&&r.skipLogic.conditions)for(var i=0,n=r.skipLogic.conditions.length;i<n;i++){var s=r.skipLogic.conditions[i],l=u(r,s.source);s.source=l.linkId}if(r.dataControl)for(i=0,n=r.dataControl.length;i<n;i++){var f=r.dataControl[i].source;if(f&&(!f.sourceType||"INTERNAL"===f.sourceType)&&f.sourceItemCode){if(!(l=u(r,f.sourceItemCode)))throw new Error("Data control for item '"+r.question+"' refers to source item '"+f.sourceItemCode+"' which was not found as a sibling, ancestor, or ancestor sibling.");f.sourceLinkId=l.linkId,delete f.sourceItemCode}}if(r.calculationMethod&&r.calculationMethod.value&&Array.isArray(r.calculationMethod.value)){var c=[];for(i=0,n=r.calculationMethod.value.length;i<n;i++){l=u(r,r.calculationMethod.value[i]);c.push(l.linkId)}r.calculationMethod.value=c}r.items&&r.items.length>0&&a(r.items)}}function u(e,t){var o=null;if(e._parentItem&&Array.isArray(e._parentItem.items))for(var r=0,i=e._parentItem.items.length;r<i;r++)if(e._parentItem.items[r].questionCode===t){o=e._parentItem.items[r];break}if(!o)for(var n=e._parentItem;n;){var s=!1;if(n.questionCode===t)o=n,s=!0;else if(n._parentItem&&Array.isArray(n._parentItem.items)){var a=n._parentItem.items;for(r=0,i=a.length;r<i;r++)if(a[r].questionCode===t){o=a[r],s=!0;break}}if(s)break;n=n._parentItem}return o}t.exports=function(e){return!o().isFHIRResource(e)&&e.items&&i(e),e}})),u=e(((e,t)=>{t.exports=function(e){let t=o(),r=e.meta;if(r){let e=r.tag;if(e)for(let o of e)if(t.versionFromTag(o)){o.display&&!o.code&&(o.code=o.display,delete o.display);break}}return"Questionnaire"===e.resourceType&&t.findItemByExtension(e,(function(e){if(e.extension)for(let t=0;t<e.extension.length;t++)"http://hl7.org/fhir/StructureDefinition/questionnaire-answerRepeats"===e.extension[t].url&&(e.repeats=!0,e.extension.splice(t,1),t-=1)})),e}})),l=e(((e,t)=>{t.exports=function(e){let t=o();return(!t.isFHIRResource(e)||"Questionnaire"===e.resourceType)&&t.findExtensions(e,(function(e){for(let t of e)"http://hl7.org/fhir/StructureDefinition/questionnaire-observationLinkPeriod"===t.url&&(t.url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-observationLinkPeriod")})),e}})),f=e(((e,t)=>{t.exports={},t.exports["29.0.0"]=r(),t.exports["28.0.0"]=i(),t.exports["26.0.0"]=n(),t.exports["25.0.0"]=s(),t.exports["24.0.0"]=a(),t.exports["23.0.0"]=u(),t.exports["22.0.0"]=l()})),c=e(((e,r)=>{var i=t(),n=f();r.exports={update:function(e,t){let r=t,s=o();var a,u=s.isFHIRResource(e);if(u){let t=e.meta;if(t){let e=t.tag;if(e)for(let t of e){let e=s.versionFromTag(t);if(e){a=e;break}}}}else a=e.lformsVersion;let l=[];for(let e,t=0,o=i.length;t<o&&(e=i[t])&&s.versionLessThan(a,e);++t)(!r||!s.versionLessThan(r,e))&&l.push(e);let f=l[0];for(let t of l.reverse())e=n[t](e);if(l.length)if(u){let t=e.meta;t||(t=e.meta={});let o,r=t.tag;r||(r=t.tag=[]);for(let e of r)if(s.versionFromTag(e)){o=e;break}let i=s.makeVersionTag(f);o?(o.code=i,delete o.display):r.push({code:i})}else e.lformsVersion=f;return e}}}))();window.lformsUpdater=c})();
//# sourceMappingURL=index.f69a69d1.js.map
